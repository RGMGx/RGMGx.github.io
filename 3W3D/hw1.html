<!DOCTYPE html>
<html lang="en">
	
	<body>

		<div>
  <!--
  <div id="light" style="position:absolute;top:10vw;left:30vw;  
background:pink;width:20px;height:20px;  
border-radius:15px;z-index:1"></div>
-->
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

  <img src="https://rgmgx.github.io/3W3D/xmastree.jpg" style="position:absolute;top:0vw;left:0vw;width:100vw;z-index:-1">

</div>

<p id='status'></p>
<button id="toggle">
Turn OFF
</button>

		<script>
	var status = 1;

var turn = 0

class Light {

  constructor() {
    // create/append div dynamically
    // https://stackoverflow.com/questions/14004117/create-div-and-append-div-dynamically
    this.element = document.createElement('div');
    //this = iDiv;
    this.element.id = 'light';
    // set element style attribute
    //https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/style
    this.element.style.cssText = "position:absolute;width:20px;height:20px;border-radius:30px;z-index:1";
    this.element.style.top = '30vw';
    this.element.style.left = '30vw';
    // CSS color property: https://www.w3schools.com/cssref/pr_text_color.asp
    // hsl: https://www.w3schools.com/colors/colors_hsl.asp
    this.element.style.background = "hsl(100, 100%, 30%)";
    document.getElementsByTagName('body')[0].appendChild(this.element);
  }

  changeColor() {
    // https://stackoverflow.com/questions/45147661/javascript-recursion-within-a-class/45147713

    // setTimeout ( self.changeColor , 1000);  // why this is not working ...
    var self = this;
    var hue = Math.random() * 200;
    /*
 
    }*/
    if (turn == 0) {
      self.element.style.background = "hsl(" + hue + ", 80%, 50%)";
      setTimeout(function() {
        self.changeColor()
      }, 500);
      console.log("555")
    }
  }
  off() {
    var self = this;
    if (turn == 1) {
      self.element.style.background = "hsl( 50, 0%, 50%)";
      setTimeout(function() {
        self.off()
      }, 500);
      console.log("444")
    }
  }

}

////////////////////////////////
init();		

function init() {
  var light = new Light();
  light.element.style.top = '30vw';
  light.element.style.left = '54vw';
  // light.changeColor();
  var light2 = new Light();
  light2.element.style.top = '24vw';
  light2.element.style.left = '38vw';
  // light2.changeColor();
  var light3 = new Light();
  light3.element.style.top = '50vw';
  light3.element.style.left = '60vw';
  // light3.changeColor();
  var light4 = new Light();
  light4.element.style.top = '60vw';
  light4.element.style.left = '50vw';
  // light4.changeColor();
  var light5 = new Light();
  light5.element.style.top = '40vw';
  light5.element.style.left = '45vw';
  //light5.changeColor();
  var light6 = new Light();
  light6.element.style.top = '70vw';
  light6.element.style.left = '60vw';
  // light6.changeColor();
  var light7 = new Light();
  light7.element.style.top = '80vw';
  light7.element.style.left = '20vw';
  // light7.changeColor();
  var light8 = new Light();
  light8.element.style.top = '75vw';
  light8.element.style.left = '40vw';
  //light8.changeColor();
  var light9 = new Light();
  light9.element.style.top = '65vw';
  light9.element.style.left = '37vw';
  // light9.changeColor();
  var light10 = new Light();
  light10.element.style.top = '90vw';
  light10.element.style.left = '70vw';
  // light10.changeColor();
  var light11 = new Light();
  light11.element.style.top = '87vw';
  light11.element.style.left = '33vw';
  // light11.changeColor();
  var light12 = new Light();
  light12.element.style.top = '69vw';
  light12.element.style.left = '13vw';
  // light12.changeColor();
  var light13 = new Light();
  light13.element.style.top = '67vw';
  light13.element.style.left = '77vw';
  // light13.changeColor();

  $('#toggle').click(function() {
    status = -status
    if (status == 1) {
      //self.element.style.background = "hsl(40, 20%, 50%)";
      $('#toggle').text('Turn ON');
      turn = 1
      light.off();
      light2.off();
      light3.off();
      light4.off();
      light5.off();
      light6.off();
      light7.off();
      light8.off();
      light9.off();
      light10.off();
      light11.off();
      light12.off();
      light13.off();
    } else {
      turn = 0
      //self.element.style.background = "hsl(" + hue + ", 80%, 50%)";
      light.changeColor();
      light2.changeColor();
      light3.changeColor();
      light4.changeColor();
      light5.changeColor();
      light6.changeColor();
      light7.changeColor();
      light8.changeColor();
      light9.changeColor();
      light10.changeColor();
      light11.changeColor();
      light12.changeColor();
      light13.changeColor();

      $('#toggle').text('Turn OFF');


    }
  });

}


		</script>
	</body>
</html>